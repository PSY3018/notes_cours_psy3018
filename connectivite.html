
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Connectivité fonctionnelle &#8212; Méthodes en neurosciences cognitives</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IRM de diffusion" href="irm_diffusion.html" />
    <link rel="prev" title="IRM fonctionnelle" href="irm_fonctionnelle.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Méthodes en neurosciences cognitives</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cartes_cerebrales.html">
   Cartes cérébrales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm.html">
   Imagerie par résonance magnétique
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morphometrie.html">
   Analyses morphométriques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm_fonctionnelle.html">
   IRM fonctionnelle
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Connectivité fonctionnelle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm_diffusion.html">
   IRM de diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tep.html">
   Tomographie par émission de positrons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imagerie_optique.html">
   Imagerie optique
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cartes_statistiques.html">
   Cartes statistiques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reproductibilite.html">
   Reproductibilité et controverses
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/connectivite.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/connectivite.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/psy3018/notes_cours_psy3018/main?urlpath=tree/methodes_neurocog/connectivite.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objectifs">
   Objectifs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#carte-de-connectivite-fonctionnelle">
   Carte de connectivité fonctionnelle
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#le-reseau-du-mode-par-defaut">
   Le réseau du mode par défaut
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reseaux-fonctionnels">
   Réseaux fonctionnels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusions">
   Conclusions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   Références
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercices">
   Exercices
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="connectivite-fonctionnelle">
<span id="connectivite-chapitre"></span><h1>Connectivité fonctionnelle<a class="headerlink" href="#connectivite-fonctionnelle" title="Permalink to this headline">¶</a></h1>
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/sangfrois">
        <img src="https://avatars.githubusercontent.com/u/38385719?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>François Lespinasse</b></sub>
      </a>
      <br />
        <a title="Contenu">🤔</a>
        <a title="Révision du texte">👀</a>
    </td>
    <td align="center">
      <a href="https://github.com/pbellec">
        <img src="https://avatars.githubusercontent.com/u/1670887?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Pierre bellec</b></sub>
      </a>
      <br />
        <a title="Contenu">🤔</a>
        <a title="Code">💻</a>
        <a title="Exercices">⚠️</a>
        <a title="Révision du texte">👀</a>
    </td>
  </tr>
</table>
<div class="section" id="objectifs">
<h2>Objectifs<a class="headerlink" href="#objectifs" title="Permalink to this headline">¶</a></h2>
<p>Dans le chapitre sur les <a class="reference internal" href="irm_fonctionnelle.html"><span class="doc std std-doc">cartes d’activation en IRMf</span></a>, nous avons vu que ce type d’analyse met l’emphase sur la notion de ségrégation fonctionnelle, c’est à dire à quel point certaines régions cérébrales sont engagées spécifiquement par une certaine catégorie de processus cognitifs. Mais il est bien connu que les processus cognitifs requièrent aussi un certain degré d’<strong>intégration fonctionnelle</strong>, où différentes régions du cerveau interagissent ensemble pour effectuer une tâche. Cette notion d’intégration amène à concevoir le cerveau comme un réseau, ou encore un graphe, qui décrit la <strong>connectivité fonctionnelle</strong> entre régions du cerveau. Ce chapitre introduit des notions de base utilisées pour étudier la connectivité du cerveau à l’aide de l’IRMf.</p>
<div class="figure align-default" id="brain-graph-fig">
<a class="reference internal image-reference" href="_images/brain-graph-fig.png"><img alt="_images/brain-graph-fig.png" src="_images/brain-graph-fig.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 51 </span><span class="caption-text">Graphe de connectivité fonctionnelle moyen sur le jeu de données ADHD-200. Chaque noeud du graphe représente une région de cerveau, et les connexions représentent la connectivité fonctionnelle moyenne sur le jeu de données ADHD-200 <span id="id1">[<a class="reference internal" href="#id20">HD200Consortium12</a>]</span>, après seuillage. L’échelle de couleur et la taille des noeuds représentent le nombre de connexions (degré) associé à chaque noeud. Le graphe est généré à l’aide de la librairie <a class="reference external" href="https://gephi.org/">gephi</a>. La figure est tirée de <span id="id2">[<a class="reference internal" href="#id21">BCCD+17</a>]</span>, sous licence CC-BY.</span><a class="headerlink" href="#brain-graph-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Les objectifs spécifiques du chaptire sont de:</p>
<ul class="simple">
<li><p>Comprendre la définition de la <strong>connectivité fonctionnelle</strong>.</p></li>
<li><p>Comprendre la distinction entre activité <strong>intrinsèque</strong> et <strong>évoquée</strong>.</p></li>
<li><p>Comprendre la notion de <strong>réseau fonctionnel</strong>.</p></li>
<li><p>Connaître les <strong>principaux réseaux au repos</strong>.</p></li>
</ul>
</div>
<div class="section" id="carte-de-connectivite-fonctionnelle">
<h2>Carte de connectivité fonctionnelle<a class="headerlink" href="#carte-de-connectivite-fonctionnelle" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span><span class="p">,</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span> <span class="c1"># Fetch data using nilearn</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>


<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Initialise la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>

<span class="c1"># Charge les données par voxel</span>
<span class="n">masker_voxel</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiMasker</span><span class="p">(</span><span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span>
                                     <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # voxels))&quot;</span><span class="p">)</span>

<span class="c1"># Montre une parcelle</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel</span> <span class="o">=</span> <span class="mi">73</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;région cible (M1 droit)&quot;</span><span class="p">)</span>

<span class="c1"># plot la série temporelle d&#39;une région</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Série temporelle&#39;</span><span class="p">)</span>

<span class="c1"># carte de connectivité</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seed_to_voxel_correlations</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tseries</span><span class="p">[:,</span> <span class="n">num_parcel</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Show the connectivity map</span>
<span class="n">conn_map</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">seed_to_voxel_correlations</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">conn_map</span><span class="p">,</span>
                       <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                       <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
                       <span class="n">title</span><span class="o">=</span><span class="s2">&quot;carte de connectivité (M1 droit)&quot;</span><span class="p">)</span>

<span class="c1"># Montre une parcelle</span>
<span class="n">num_parcel</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;région cible (PCC)&quot;</span><span class="p">)</span>

<span class="c1"># plot la série temporelle d&#39;une région</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Série temporelle&#39;</span><span class="p">)</span>


<span class="c1"># carte de connectivité</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seed_to_voxel_correlations</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tseries</span><span class="p">[:,</span> <span class="n">num_parcel</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Show the connectivity map</span>
<span class="n">conn_map</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">seed_to_voxel_correlations</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">conn_map</span><span class="p">,</span>
                       <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
                       <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s2">&quot;carte de connectivité (PCC)&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;fcmri-map-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-center" id="fcmri-map-fig" style="width: 600px">
<div class="cell_output docutils container">
<img alt="_images/connectivite_1_3.png" src="_images/connectivite_1_3.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 52 </span><span class="caption-text">Cartes de connectivité au repos générées à partir des données IRMf d’un individu du jeu de données ADHD-200 <span id="id3">[<a class="reference internal" href="#id20">HD200Consortium12</a>]</span>. Pour chaque carte, la région cible utilisée ainsi que les cinq premières minutes d’activité BOLD associée à la région cible sont représentées. Cette figure est générée par du code python à l’aide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> (cliquer sur + pour voir le code), et est distribuée sous licence CC-BY.</span><a class="headerlink" href="#fcmri-map-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Avant de parler de connectivité fonctionnelle, revisitons le concept de cartes d’activation en IRMf. Comme nous l’<a class="reference internal" href="irm_fonctionnelle.html#activation-section"><span class="std std-ref">avons vu</span></a>, on génère une carte d’activation en comparant les fluctuations BOLD dans une région donnée du cerveau avec une prédiction de la réponse cérébrale associée à une tâche. De manière simplifiée, la carte d’activation nous montre la corrélation entre l’activité attendue (sur la base du paradigme expérimentale et d’une fonction de réponse hémodynamique) et l’activité mesurée à chaque voxel.</p>
<p>Une carte de connectivité relève un peu de la même logique. Mais au lieu de nous intéresser à la réponse attendue en réponse à une tâche, nous allons nous intéresser à l’activité d’une région particulière du cerveau, appelée <strong>région cible</strong>. Nous allons alors mesurer la corrélation entre le décours temporel de chaque voxel dans le cerveau et décours temporel de la région cible. Nous allons obtenir une <strong>carte de connectivité fonctionnelle</strong> qui nous montre quelles régions du cerveau ont une activité très corrélée (ou synchrone) avec la région cible.</p>
<div class="tip admonition" id="correlation">
<p class="admonition-title">Mesure de corrélation</p>
<p>La <a class="reference external" href="https://fr.wikipedia.org/wiki/Corr%C3%A9lation_(statistiques)">corrélation</a> entre deux séries temporelles est une mesure qui varie entre -1 et 1. Si les deux séries sont identiques (à leur moyenne et variance près), la corrélation est de 1. Si les deux séries sont statistiquement indépendantes, la corrélation est proche de zéro. Si les deux séries sont mirroirs l’une de l’autre, la corrélation est de -1.</p>
</div>
<p>La <em><strong>connectivité fonctionnelle</strong></em> est un terme relativement générique utilisé pour décrire un ensemble de techniques permettant d’analyser les patterns spatiaux de l’activité cérébrale <span id="id4">[<a class="reference internal" href="#id38">FR07</a>]</span>. Fox et Raischle (2007) propose que la technique la plus simple pour mener ce genre d’analyse est effectivement d’extraire le décours temporel BOLD d’une <strong>région cible</strong> et d’en déterminer la corrélation d’avec le reste des voxels. Des techniques plus sophistiquées ont été développées afin de surpasser les limites de cette modélisation. Elles seront discuté à la fin de ce chapitre.</p>
<p>Le concept de carte fonctionnelle a été introduit par Biswal et collègues (1995) <span id="id5">[<a class="reference internal" href="#id37">BYHH95</a>]</span>, en utilisant une cible dans le cortex sensorimoteur primaire droit. Cette région cible avait été obtenue avec une carte d’activation et une tâche motrice. Biswal et collègues ont alors eu l’idée d’observer les fluctuations BOLD dans une condition de <strong>repos</strong>, en l’absence de tâche expérimentale. Cette carte révèle un ensemble distribué de régions (voir <a class="reference internal" href="#fcmri-map-fig"><span class="std std-numref">Fig. 52</span></a>, cible M1 droit), qui comprend le cortex sensorimoteur gauche, mais aussi l’aire motrice supplémentaire, le cortex prémoteur et d’autres régions du cerveau connues pour leur implication dans le <strong>réseau moteur</strong>. Cette étude a tout d’abord engendré beaucoup de septicisme, au motif que ces patrons d’activité fonctionnelle corrélée aurait pu refléter du bruit cardiaque ou respiratoire.</p>
<div class="tip admonition" id="fluctuations-lentes">
<p class="admonition-title">Fluctuations lentes</p>
<p>Une autre observation clé de Biswal et collègues (1995) <span id="id6">[<a class="reference internal" href="#id37">BYHH95</a>]</span> est que le signal BOLD au repos est dominé par des fluctuations lentes, avec des bouffées d’activité d’une durée de 20 à 30 secondes, clairement visibles dans la <a class="reference internal" href="#fcmri-map-fig"><span class="std std-numref">Fig. 52</span></a>. Plus spécifiquement, le spectre du signal BOLD au repos est dominée par les fréquences inférieures à 0.08 Hz, et même 0.03-0.05 Hz.</p>
</div>
<p>La crédibilité des cartes de connectivité au repos s’est renforcée quand différents groupes de recherche ont pu identifié d’autres réseaux en utilisant des régions cibles différentes, notamment le réseau visuel et le réseau auditif. Mais c’est l’étude de Greicius et collaborateurs, en 2003 <span id="id7">[<a class="reference internal" href="#id39">GKRM03</a>]</span>, qui a déclenché un énorme intérêt pour les cartes de connectivité au repos en utilisant une région cible dans le cortex cingulaire postérieur (PCC) pour identifier un réseau fonctionnel qui n’avait pas encore été identifié: le <strong>réseau du mode par défaut</strong> (voir <a class="reference internal" href="#fcmri-map-fig"><span class="std std-numref">Fig. 52</span></a>, cible PCC). Nous allons discuter dans la prochaine section des origines de ce réseau, et comment il peut nous aider à comprendre ce que mesure la connectivité au repos. Il est également important de mentionner que le travail de Shmuel et collèges (2008) <span id="id8">[<a class="reference internal" href="#id40">SL08</a>]</span> a démontré que l’activité BOLD au repos corrèle aux fluctuations spontanées d’activité neuronales dans le cortex visuel d’un macaque anésthésié, ce qui démontre que la connectivité fonctionnelle reflète au moins partiellement la synchronie de l’activité neuronale, et pas simplement du bruit physiologique (cardiaque, respiration).</p>
<div class="caution attention admonition" id="fcmri-map-warning">
<p class="admonition-title">Variabilité intra- et inter-individuelle</p>
<p>La <a class="reference internal" href="#fcmri-map-fig"><span class="std std-numref">Fig. 52</span></a> peut donner l’impression que les réseaux de connectivité sont extrêmement stables. En réalité, les cartes de connectivité varient beaucoup au cours du temps, c’est à dire en regardant différentes fenêtres d’activité pour un même individu, et également entre individus. Effectivement, les coordonnées d’une région cible peuvent être partiellement inexactes même si on procède au recalage des images. Caractériser la variabilité intra- et inter-individuelle des cartes de connectivité est un domaine de recherche actif.</p>
</div>
</div>
<div class="section" id="le-reseau-du-mode-par-defaut">
<h2>Le réseau du mode par défaut<a class="headerlink" href="#le-reseau-du-mode-par-defaut" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># load fMRI data</span>
<span class="n">subject_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_spm_auditory</span><span class="p">()</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">concat_imgs</span><span class="p">(</span><span class="n">subject_data</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>

<span class="c1"># Make an average</span>
<span class="n">mean_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">mean_img</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">masking</span><span class="o">.</span><span class="n">compute_epi_mask</span><span class="p">(</span><span class="n">mean_img</span><span class="p">)</span>

<span class="c1"># Clean and smooth data</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">clean_img</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="n">high_pass</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t_r</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">smooth_img</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="mf">8.</span><span class="p">)</span>

<span class="c1"># load events</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">subject_data</span><span class="p">[</span><span class="s1">&#39;events&#39;</span><span class="p">])</span>

<span class="c1"># Fit model</span>
<span class="n">fmri_glm</span> <span class="o">=</span> <span class="n">FirstLevelModel</span><span class="p">(</span><span class="n">t_r</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                           <span class="n">drift_model</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
                           <span class="n">signal_scaling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">mask_img</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>                           
                           <span class="n">minimize_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fmri_glm</span> <span class="o">=</span> <span class="n">fmri_glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>

<span class="c1"># Extract activation clusters</span>
<span class="n">z_map</span> <span class="o">=</span> <span class="n">fmri_glm</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="s1">&#39;active - rest&#39;</span><span class="p">)</span>

<span class="c1"># plot activation map</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
        <span class="n">z_map</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">mean_img</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;carte d</span><span class="se">\&#39;</span><span class="s1">activation (auditif)&#39;</span><span class="p">)</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;deactivation-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-center" id="deactivation-fig" style="width: 600px">
<div class="cell_output docutils container">
<img alt="_images/connectivite_3_0.png" src="_images/connectivite_3_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 53 </span><span class="caption-text">Carte d’activation individuelle dans un paradigme auditif (jeu de données <a class="reference external" href="https://www.fil.ion.ucl.ac.uk/spm/data/auditory/">spm_auditory</a>). Le seuil de significativité est sélectionné de manière libérale (<code class="docutils literal notranslate"><span class="pre">|z|&gt;2</span></code>). Une déactivation modérée est identifiée dans différentes régions du cerveau, incluant le cortex cingulaire postérieur (PCC) et le cortex préfrontal médian (mPFC). Le PCC et le mPFC sont des régions clés du réseau du mode par défaut. Cette figure est générée par du code python à l’aide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> (cliquer sur + pour voir le code), et est distribuée sous licence CC-BY.</span><a class="headerlink" href="#deactivation-fig" title="Permalink to this image">¶</a></p>
</div>
<p>La découverte du mode par défaut a été réalisée au travers d’étude par activation, en TEP. En 1997, Shulman et collègues <span id="id9">[<a class="reference internal" href="#id42">SFC+97</a>]</span> combinent 9 études PET qui utilisent la même condition de contrôle de “repos” (consistant à regarder des stimuli visuels de manière passive), et des tâches variées mais cognitivement demandantes. Les auteurs démontrent qu’un ensemble de régions sont systématiquement plus impliquées au repos que durant la tâche, incluant notamment le cortex cingulaire postérieur (PCC). En 2001, Gusnard et Raichle <span id="id10">[<a class="reference internal" href="#id43">RMS+01</a>]</span> s’appuyent sur l’étude de Shulman et al. pour formuler la désormais célèbre “<em>hypothèse du mode par défaut</em>”. Il existerait un certain nombre de processus cognitifs d’introspection qui seraient systématiquement présents dans un état de repos, et il existerait un réseau fonctionnel qui soutiendrait cette activité “par défaut”. Pour confirmer cette hypothèse, Greicius et collègues <span id="id11">[<a class="reference internal" href="#id39">GKRM03</a>]</span> ont utilisé une carte de connectivité au repos en IRMf avec une région cible dans le PCC, et ont identifié un réseau d’activité spontanée au repos très similaire spatialement au réseau du mode par défaut, voir <a class="reference internal" href="#fcmri-map-fig"><span class="std std-numref">Fig. 52</span></a>. Le contexte de réseau du mode par défaut a depuis évolué, voir la revue de Buckner et DiNicola (2019) <span id="id12">[<a class="reference internal" href="#id41">BD19</a>]</span> pour une revue récente de sa neuroanatomie et de ses rôles cognitifs.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>

<span class="c1"># Charge les données par voxel</span>
<span class="n">masker_voxel</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiMasker</span><span class="p">(</span><span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span>
                                     <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # voxels))&quot;</span><span class="p">)</span>

<span class="c1"># Applique une correction du signal global</span>
<span class="kn">from</span> <span class="nn">nilearn.signal</span> <span class="kn">import</span> <span class="n">clean</span> <span class="k">as</span> <span class="n">signal_clean</span>
<span class="n">gb_signal</span> <span class="o">=</span> <span class="n">signal_clean</span><span class="p">(</span>
                        <span class="n">tseries</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]),</span>
                        <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                        <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">],</span> <span class="n">confounds</span><span class="o">=</span><span class="n">gb_signal</span><span class="p">)</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">],</span> <span class="n">confounds</span><span class="o">=</span><span class="n">gb_signal</span><span class="p">)</span>

<span class="c1"># Montre une parcelle</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel</span> <span class="o">=</span> <span class="mi">113</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;région cible (FEF)&quot;</span><span class="p">)</span>

<span class="c1"># plot la série temporelle d&#39;une région</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Série temporelle&#39;</span><span class="p">)</span>

<span class="c1"># carte de connectivité</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seed_to_voxel_correlations</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tseries</span><span class="p">[:,</span> <span class="n">num_parcel</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Show the connectivity map</span>
<span class="n">conn_map</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">seed_to_voxel_correlations</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">conn_map</span><span class="p">,</span>
                       <span class="n">threshold</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                       <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                       <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
                       <span class="n">display_mode</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s2">&quot;carte de connectivité (FEF)&quot;</span><span class="p">)</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;negative-DMN-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-center" id="negative-dmn-fig" style="width: 600px">
<div class="cell_output docutils container">
<img alt="_images/connectivite_5_2.png" src="_images/connectivite_5_2.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 54 </span><span class="caption-text">Une région cible est sélectionnée au niveau “frontal eye field” (FEF), pour générer une carte de connectivité sur un sujet du jeu de données ADHD-200 <span id="id13">[<a class="reference internal" href="#id20">HD200Consortium12</a>]</span>. Le seuil de significativité est sélectionné de manière libérale (<code class="docutils literal notranslate"><span class="pre">|r|&gt;0.2</span></code>). En plus du réseau attentional dorsal associé au FEF, la carte de connectivité met en évidence une corrélation négative avec le PCC et le cortex cingulaire antérieure (ACC). L’ACC et le PCC sont des régions clés du réseau du mode par défaut. Cette figure est générée par du code python à l’aide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> (cliquer sur + pour voir le code), et est distribuée sous licence CC-BY.</span><a class="headerlink" href="#negative-dmn-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Le réseau du mode par défaut n’est pas le seul que l’on puisse identifier au repos. On a déjà vu le réseau sensorimoteur qui a été le premier identifié par Biswal. Un autre réseau couramment examiné dans la litérature est le réseau attentionel dorsal (DAN), qui comprend notamment les sillons intra-pariétaux supérieurs (IPS) et les champs occulaires frontaux (FEF). Le DAN est souvent identifié comme activé dans les expériences utilisant une tâche cognitivement demandante en IRMf, et est parfois appelé le “task positive network” - même s’il n’est pas positivement engagé par toutes les tâches. En 2005, Fox et collègues <span id="id14">[<a class="reference internal" href="#id44">FSV+05</a>]</span> remarquent une corrélation négative entre le DAN et le réseau du mode par défaut. Cette analyse renforce la notion de transitions spontanées entre un état mental dirigé vers les stimuli extérieurs, et un état introspectif, reflétant la compétition entre deux réseaux distribués.</p>
<div class="caution attention admonition" id="negative-r-warning">
<p class="admonition-title">Controverses sur la régression du signal global</p>
<p>Les corrélations négatives de la <a class="reference internal" href="#negative-dmn-fig"><span class="std std-numref">Fig. 54</span></a> sont fortes uniquement quand on applique certaines étapes de débruitage des données, et notamment la <em>régression du signal global</em>. Une controverse importante est née autour des connexions négatives, car certains chercheurs pensent qu’il s’agit d’un artefact lié à cette étape de prétraitement. Malgré tout, les corrélations négatives peuvent être observées de manière robuste pour les sujets qui bougent très peu, et dont le signal est donc particulièrement propre. Leur amplitude est cependant faible en l’absence de régression du signal global.</p>
</div>
<div class="tip admonition" id="intrinseque-tip">
<p class="admonition-title">Activité intrinsèque vs extrinsèque</p>
<p>Les réseaux au repos peuvent être observés même en présence d’une tâche. Plutôt qu’opposer la notion de repos et de tâche, il est courant de parler d’activité intrinsèque et extrinsèque. L’<strong>activité extrinséque</strong> est l’activité évoquée par une tâche, et reflète la manière dont l’environnement influence l’activité cérébrale. En revanche, l’<strong>activité intrinsèque</strong> désigne l’activité cérébrale qui émerge spontanément, et est indépendante des stimuli extérieurs. Les deux types d’activité sont toujours présentes, en peuvent interagir l’une avec l’autre.</p>
</div>
</div>
<div class="section" id="reseaux-fonctionnels">
<h2>Réseaux fonctionnels<a class="headerlink" href="#reseaux-fonctionnels" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>


<span class="c1"># Applique une correction du signal global</span>
<span class="kn">from</span> <span class="nn">nilearn.signal</span> <span class="kn">import</span> <span class="n">clean</span> <span class="k">as</span> <span class="n">signal_clean</span>
<span class="n">gb_signal</span> <span class="o">=</span> <span class="n">signal_clean</span><span class="p">(</span>
                        <span class="n">tseries</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]),</span>
                        <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                        <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">],</span> <span class="n">confounds</span><span class="o">=</span><span class="n">gb_signal</span><span class="p">)</span>

<span class="c1"># Affiche le template</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;parcellisation&quot;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">)</span>

<span class="c1"># We generate a connectome</span>
<span class="kn">from</span> <span class="nn">nilearn.connectome</span> <span class="kn">import</span> <span class="n">ConnectivityMeasure</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ConnectivityMeasure</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">tseries</span><span class="p">]))</span>

<span class="c1"># we use scipy&#39;s hierarchical clustering implementation</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">cut_tree</span>
<span class="c1"># That&#39;s the hierarchical clustering step</span>
<span class="n">hier</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span> <span class="c1"># scipy&#39;s hierarchical clustering</span>
<span class="c1"># HAC proceeds by iteratively merging brain regions, which can be visualized with a tree</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">hier</span><span class="p">,</span> <span class="n">get_leaves</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Generate a dendrogram from the hierarchy</span>
<span class="n">order</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;leaves&#39;</span><span class="p">)</span> <span class="c1"># Extract the order on parcels from the dendrogram</span>
<span class="n">part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">cut_tree</span><span class="p">(</span><span class="n">hier</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Montre le connectome</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;régions&#39;</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;connectome&#39;</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">ax_plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">conn</span><span class="p">[</span><span class="n">order</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">order</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">)</span>

<span class="c1"># Montre les réseaux</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">part_img</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">122</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># note the sneaky shift to 1-indexing</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">part_img</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;réseaux&quot;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;network-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-center" id="network-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/connectivite_7_1.png" src="_images/connectivite_7_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 55 </span><span class="caption-text">Une parcellisation fonctionnelle du cerveau avec 122 parcelles est présentée à gauche (BASC). Au centre, on voit une matrice où chaque élément représente la corrélation entre l’activité de deux parcelles. Les parcelles ont été ordonnées de manière à mettre en évidence des carrés diagonaux: ce sont des groupes de régions dont l’activité corrèlent fortement entre elles, et peu avec le reste du cerveau. Des algorithmes de type clustering permettent de détecter automatiquement ces groupes de parcelles, appelés réseaux fonctionnels. Un exemple de réseaux fonctionnels générés avec un clustering hiérachique est présenté à droite, qui identifie notamment le réseau du mode par défaut. Cette figure est générée par du code python à l’aide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> (cliquer sur + pour voir le code), et est distribuée sous licence CC-BY.</span><a class="headerlink" href="#network-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Dans la dernière section, nous avons parlé à plusieurs reprises de <em><strong>réseau fonctionnel</strong></em>, mais sans vraiment définir ce que c’est. Lorsqu’on utilise une carte de connectivité, le réseau fonctionnel est l’ensemble des régions qui apparaissent dans la carte, et qui sont donc connectées à notre région cible. Mais cette approche dépend de la région cible. Pourtant, il est intuitif que toutes les cartes de connectivité utilisant des cibles dans, par exemple, le mode par défaut vont se ressembler. Pour formaliser cette intuition, nous avons besoin d’introduire la notion de connectome fonctionnel.</p>
<p>Un <strong>connectome fonctionnel</strong> est une matrice qui représente toutes les connexions (fonctionnelles) du cerveau. On commence donc par sélectionner une parcellisation cérébrale, puis l’on calcule la corrélation de l’activité temporelle pour toutes les paires de parcelles dans le cerveau. Cette matrice de corrélation est de taille <code class="docutils literal notranslate"><span class="pre">#parcelles</span> <span class="pre">x</span> <span class="pre">#parcelles</span></code>. En utilisant des techniques d’apprentissage non-supervisé, de type clustering, il est possible d’identifier des groupes de parcelles qui sont fortement connectées les unes aux autres, et peu connectées au reste du cerveau. C’est la définition la plus courant d’un réseau fonctionnel. Ce type d’approche permet de découper le cerveau en réseaux, de manière automatique et guidée par les données.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span> <span class="c1"># Fetch data using nilearn</span>
<span class="n">atlas_yeo</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_yeo_2011</span><span class="p">()</span>        <span class="c1"># the Yeo-Krienen atlas</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Let&#39;s plot the Yeo-Krienen 7 clusters parcellation</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Yeo-Krienen atlas-7&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;(img==1).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Visuel&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;2 * (img==2).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sensorimoteur&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;3 * (img==3).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Attentionnel dorsal&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">27</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;4 * (img==4).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Attentionnel ventral / salience&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;5 * (img==5).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mésolimbique&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;6 * (img==6).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;frontopariétal&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;7 * (img==7).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mode par défaut&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;yeo-krienen-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-center" id="yeo-krienen-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/connectivite_9_0.png" src="_images/connectivite_9_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 56 </span><span class="caption-text">Atlas de Yeo-Krienen <span id="id15">[<a class="reference internal" href="#id45">YKS+11</a>]</span> construit par une analyse de clustering à partir de données IRMf au repos d’un grand nombre de sujets. Les réseaux sont définis à plusieurs résolutions dans cet atlas (7 et 17). Ici, le découpage en 7 grands réseaux distribués est présenté. Cette figure est générée par du code python à l’aide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> (cliquer sur + pour voir le code), et est distribuée sous licence CC-BY.</span><a class="headerlink" href="#yeo-krienen-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Il n’y a pas un nombre exact de réseaux cérébraux, mais plutôt une hiérarchie de réseaux plus ou moins spécialisés. Malgré tout, de nombreux articles ont étudiés un découpage en 7 réseaux corticaux. L’atlas de Yeo, Krienen et collègues <span id="id16">[<a class="reference internal" href="#id45">YKS+11</a>]</span> est très utilisé, et identifient sept grands réseaux. Certains de ces réseaux ont déjà été discutés dans ce chapitre: mode par défaut, attentionnel dorsal, sensorimoteur. Il faut ajouter deux autres réseaux associatifs: le frontopariétal et l’attentionnel ventral (parfois appelé salince). Il y a également un réseau visuel, et un réseau mésolimbique impliquant le pôle temporal et le cortex orbitofrontal. Notez que cet atlas ignore toutes les structures sous-corticales. La même étude a proposé un découpage en 17 sous-réseaux. Vous pouvez utiliser cet <a class="reference external" href="https://simexp.github.io/multiscale_dashboard/index.html">outil interactif</a> pour explorer l’organisation multi-échelle des réseaux fonctionnels de manière interactive, à l’aide de l’atlas MIST <span id="id17">[<a class="reference internal" href="#id47">UAB+19</a>]</span>.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>La connectivité fonctionnelle consiste à mesurer la cohérence (corrélation) entre l’activité de deux régions (ou voxels) du cerveau.</p></li>
<li><p>Une carte de connectivité fonctionnelle permet d’étudier la connectivité entre une région cible et le reste du cerveau.</p></li>
<li><p>La connectivité fonctionnelle peut être observée au repos (activité spontanée), en l’absence de protocole expérimental. En général, on a une superposition de l’activité intrinséque (liée à l’activité spontanée) et extrinsèque (liée à l’environnement).</p></li>
<li><p>La connectivité IRMf au repos a joué un rôle clé dans la découverte du réseau du mode par défaut.</p></li>
<li><p>Un réseau fonctionnel est un groupe de régions dont l’activité spontanée présente une forte connectivité fonctionnelle intra-réseau, et une faible connectivité avec le reste du cerveau. Différents atlas des réseaux au repos existent, et à différentes échelles.</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>Références<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="id18"><dl class="citation">
<dt class="label" id="id21"><span class="brackets"><a class="fn-backref" href="#id2">BCCD+17</a></span></dt>
<dd><p>Pierre Bellec, Carlton Chu, François Chouinard-Decorte, Yassine Benhajali, Daniel S. Margulies, and R. Cameron Craddock. The neuro bureau adhd-200 preprocessed repository. <em>NeuroImage</em>, 144:275–286, 2017. Data Sharing Part II. <a class="reference external" href="https://doi.org/https://doi.org/10.1016/j.neuroimage.2016.06.034">doi:https://doi.org/10.1016/j.neuroimage.2016.06.034</a>.</p>
</dd>
<dt class="label" id="id37"><span class="brackets">BYHH95</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>B Biswal, F Z Yetkin, V M Haughton, and J S Hyde. Functional connectivity in the motor cortex of resting human brain using echo-planar MRI. <em>Magn. Reson. Med.</em>, 34(4):537–541, October 1995.</p>
</dd>
<dt class="label" id="id41"><span class="brackets"><a class="fn-backref" href="#id12">BD19</a></span></dt>
<dd><p>Randy L Buckner and Lauren M DiNicola. The brain's default network: updated anatomy, physiology and evolving insights. <em>Nat. Rev. Neurosci.</em>, 20(10):593–608, October 2019.</p>
</dd>
<dt class="label" id="id44"><span class="brackets"><a class="fn-backref" href="#id14">FSV+05</a></span></dt>
<dd><p>Michael D Fox, Abraham Z Snyder, Justin L Vincent, Maurizio Corbetta, David C Van Essen, and Marcus E Raichle. The human brain is intrinsically organized into dynamic, anticorrelated functional networks. <em>Proc. Natl. Acad. Sci. U. S. A.</em>, 102(27):9673–9678, July 2005.</p>
</dd>
<dt class="label" id="id38"><span class="brackets"><a class="fn-backref" href="#id4">FR07</a></span></dt>
<dd><p>Michael D. Fox and Marcus E. Raichle. Spontaneous fluctuations in brain activity observed with functional magnetic resonance imaging. <em>Nature Reviews Neuroscience</em>, 8(9):700–711, September 2007. URL: <a class="reference external" href="https://doi.org/10.1038/nrn2201">https://doi.org/10.1038/nrn2201</a>, <a class="reference external" href="https://doi.org/10.1038/nrn2201">doi:10.1038/nrn2201</a>.</p>
</dd>
<dt class="label" id="id39"><span class="brackets">GKRM03</span><span class="fn-backref">(<a href="#id7">1</a>,<a href="#id11">2</a>)</span></dt>
<dd><p>Michael D Greicius, Ben Krasnow, Allan L Reiss, and Vinod Menon. Functional connectivity in the resting brain: a network analysis of the default mode hypothesis. <em>Proc. Natl. Acad. Sci. U. S. A.</em>, 100(1):253–258, January 2003.</p>
</dd>
<dt class="label" id="id43"><span class="brackets"><a class="fn-backref" href="#id10">RMS+01</a></span></dt>
<dd><p>M E Raichle, A M MacLeod, A Z Snyder, W J Powers, D A Gusnard, and G L Shulman. A default mode of brain function. <em>Proc. Natl. Acad. Sci. U. S. A.</em>, 98(2):676–682, January 2001.</p>
</dd>
<dt class="label" id="id40"><span class="brackets"><a class="fn-backref" href="#id8">SL08</a></span></dt>
<dd><p>Amir Shmuel and David A Leopold. Neuronal correlates of spontaneous fluctuations in fMRI signals in monkey visual cortex: implications for functional connectivity at rest. <em>Hum. Brain Mapp.</em>, 29(7):751–761, July 2008.</p>
</dd>
<dt class="label" id="id42"><span class="brackets"><a class="fn-backref" href="#id9">SFC+97</a></span></dt>
<dd><p>G L Shulman, J A Fiez, M Corbetta, R L Buckner, F M Miezin, M E Raichle, and S E Petersen. Common blood flow changes across visual tasks: II. decreases in cerebral cortex. <em>J. Cogn. Neurosci.</em>, 9(5):648–663, 1997.</p>
</dd>
<dt class="label" id="id47"><span class="brackets"><a class="fn-backref" href="#id17">UAB+19</a></span></dt>
<dd><p>S Urchs, J Armoza, Y Benhajali, J St-Aubin, and others. MIST: a multi-resolution parcellation of functional brain networks [version 2; peer review: 4 approved]. <em>MNI Open Res.</em>, 2019.</p>
</dd>
<dt class="label" id="id45"><span class="brackets">YKS+11</span><span class="fn-backref">(<a href="#id15">1</a>,<a href="#id16">2</a>)</span></dt>
<dd><p>B T Thomas Yeo, Fenna M Krienen, Jorge Sepulcre, Mert R Sabuncu, Danial Lashkari, Marisa Hollinshead, Joshua L Roffman, Jordan W Smoller, Lilla Zöllei, Jonathan R Polimeni, Bruce Fischl, Hesheng Liu, and Randy L Buckner. The organization of the human cerebral cortex estimated by intrinsic functional connectivity. <em>J. Neurophysiol.</em>, 106(3):1125–1165, September 2011.</p>
</dd>
<dt class="label" id="id20"><span class="brackets">HD200Consortium12</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>,<a href="#id13">3</a>)</span></dt>
<dd><p>HD-200 Consortium. The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience. <em>Front. Syst. Neurosci.</em>, 6:62, September 2012. <a class="reference external" href="https://doi.org/https://dx.doi.org/10.3389%2Ffnsys.2012.00062">doi:https://dx.doi.org/10.3389%2Ffnsys.2012.00062</a>.</p>
</dd>
</dl>
</p>
</div>
<div class="section" id="exercices">
<h2>Exercices<a class="headerlink" href="#exercices" title="Permalink to this headline">¶</a></h2>
<p>On commence par des exercices de révisions, qui concernent la vidéo “resting-state network” suivante:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Youtube</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/_Iph3WW9UOU?start=18&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><iframe width="560" height="315" src="https://www.youtube.com/embed/_Iph3WW9UOU?start=18" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div></div>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.1.</p>
<p>“La septième jour” (sic), extrait en français: 0:54 - 4:35</p>
<ol class="simple">
<li><p>Qui représente le jeune homme?</p></li>
<li><p>À quel résultat fait-il référence?</p></li>
<li><p>Qui représente la jeune femme?</p></li>
<li><p>À quel résultat fait-elle référence?</p></li>
<li><p>Pourquoi appeler ce film “la septième jour” (sic) ?</p></li>
</ol>
</div>
<div class="tip admonition" id="neuro-meteorologie-tip">
<p class="admonition-title">Traduction de l’extrait “Neuro-météorologie”: 4:48 - 5:30</p>
<p>Regardons quelle activité intrinsèque nous arrive pour cette fin de semaine.
Comme vous pouvez le voir ici, le mode par défaut et le réseau “tâche-positif” font leurs affaires habituelles, présent / absent, yin et yang. Cela ressemble à l’activité habituelle de rêverie et de concentration intense pour la fin de semaine.
Le mode par défaut semble un peu dominant.
Le visuel sera beau, le moteur sera beau, à moins qu’une fluctuation alcoolique soudaine nous arrive du sud.
L’imagerie satellite nous indique des turbulences dans la région du précunéus qui pourraient devenir très intéressantes en début de semaine.
Mais, comme l’a dit le philosophe latin (Sénèque, NDLR): le repos est loin d’être de tout repos.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.2.</p>
<p>“Neuro-météorologie”: 4:48 - 5:30</p>
<ol class="simple">
<li><p>De quels réseaux parle-t-on ici?</p></li>
<li><p>Pourquoi qualifie-t-il le réseau du mode par défaut et le réseau “tâche-positif” de “Yin and yang”?</p></li>
<li><p>Est ce qu’il manque des réseaux dans cette prévision?</p></li>
<li><p>Pourquoi est-ce que les turbulences dans le précunéus (ou plutôt le cortex cingulaire postérieur) sont intéressantes?</p></li>
</ol>
</div>
<div class="tip admonition" id="hardball-tip">
<p class="admonition-title">Traduction de l’extrait “Hardball”: 8:01 - 9:46</p>
<ul class="simple">
<li><p>Présentateur (Pr): “Bonjour, aujourd’hui nous avons avec nous deux chercheurs distingués, Dr Yann Schnizel et Dr Paul Salami. Prêt à débattre sans compromis?”</p></li>
<li><p>Paul Salami (PS): “Je souhaite dire que le développement de la littérature sur le mode par défaut et l’état de repos propose de bonnes questions, de bonnes expériences, et cela bénéficie pour l’essentiel aux jeunes qui démarrent la recherche, mais je ne pense pas personnellement qu’étudier le repos est particulièrement utile. Si vous voulez étudier le comportement, vous le faites de la façon traditionnelle, comme nous le faisions avant, vous le faites expérimentalement.”</p></li>
<li><p>Yann Schnizel (YS): “Ce n’est pas le cas! La distinction importante n’est pas entre repos et tâche, mais plutôt entre activité intrinsèque et évoquée.”</p></li>
<li><p>PS: “Si nous sommes tous les deux d’accord pour dire que l’activité spontanée est présente dans tous les états cognitifs, je ne vois pas pourquoi nous devrions spécifiquement, je dis bien spécifiquement!, dans un état de repos.”</p></li>
<li><p>YS: “Nous ne devons certainement pas l’étudier exclusivement au repos, mais l’état de repos est LA condition dans laquelle ces fluctuations spontanées ont été étudiées de la manière la plus détaillée.”</p></li>
<li><p>PS: “Ceci est fondamentalement non-psychologique!”</p></li>
<li><p>YS: “Non!”</p></li>
<li><p>PS: “non-psychologique!”</p></li>
<li><p>YS: “VOUS êtes fondamentalement non-psychologique!”</p></li>
<li><p>PS: “au moins j’étudie la cognition durant l’instant où l’événement cognitif se passe.”</p></li>
<li><p>Pr: “whaou messieurs, les esprits s’échauffent! Calmons nous un peu. Il semble qu’il ne nous reste plus de temps.”
(bataille entre PS et YS)</p></li>
<li><p>Pr: “La semaine prochaine, dans “cluster analysis”, nous partirons sur la route avec Michael Milham, chanteur folk légendaire. Il voyage de par le monde pour partager l’histoire des réseaux au repos, en chanson. Merci d’avoir regardé cluster analysis sur le réseau du repos,”</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.3.</p>
<p>“Hardball”: 8:01 - 9:46</p>
<ol class="simple">
<li><p>Est-il vrai que l’activité spontanée est présente aussi bien au repos que durant une tâche?</p></li>
<li><p>Est-il vrai que l’activité spontanée a été principalement étudiée dans un état de repos en IRMf?</p></li>
<li><p>En quoi est-il “non psychologique” d’étudier une condition de repos?</p></li>
<li><p>Question ouverte: est ce que l’un d’entre eux a raison? Ou les deux?</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.4.</p>
<p>Carte de connectivité: vrai/faux</p>
<ol class="simple">
<li><p>Une carte de connectivité change si on change la région cible.</p></li>
<li><p>Pour définir une région cible, on doit faire une carte d’activation.</p></li>
<li><p>Une carte de connectivité fonctionnelle présente des valeurs entre 0 et 1.</p></li>
<li><p>Une carte de connectivité en IRMf est un outil pour identifier le réseau du mode par défaut.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.5.</p>
<p>Activité spontanée et évoquée: vrai/faux</p>
<ol class="simple">
<li><p>L’activité spontanée du cerveau ne s’observe que dans un état de repos.</p></li>
<li><p>L’activité cérébrale évoquée par une tâche peut être caractérisée par une carte d’activation IRMf.</p></li>
<li><p>L’activité spontanée du cerveau est plus importante au repos que pendant une tâche visuelle dans certaines parties du cerveau.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.6.</p>
<p>Réseaux fonctionnels: vrai/faux</p>
<ol class="simple">
<li><p>Il y a exactement 7 réseaux fonctionnels dans le cerveau.</p></li>
<li><p>Un réseau fonctionnel est composé de régions présentant une connectivité fonctionnelle forte.</p></li>
<li><p>Le réseau du mode par défaut peut être identifié avec une carte d’activation.</p></li>
<li><p>Les régions du réseau du mode par défaut sont corrélées négativement avec les régions du réseau sensorimoteur.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.7</p>
<p>Pour répondre à cette question, lisez l’article de Shukla et collaborateurs, “<em>Aberrant Frontostriatal Connectivity in Negative Symptoms of Schizophrenia</em>”, publié dans Schizophrenia Bulletin (2019, 45(5): 1051-59) et disponible en libre accès à cette <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6737477/">adresse</a>. Les questions suivantes sont à développement court.</p>
<ul class="simple">
<li><p>Quel logiciel a été utilisé pour analyser les données d’IRMf?</p></li>
<li><p>Quelle condition expérimentale était utilisée pendant les acquisitions d’IRMf?</p></li>
<li><p>Quel était le paramètre de lissage spatial?</p></li>
<li><p>Est-ce que les données ont été corrigées du mouvement? Pourquoi?</p></li>
<li><p>Est-ce que l’un des deux groupes a plus bougé que l’autre?</p></li>
<li><p>Quelles procédures de filtrage et correction de bruits ont été appliquées?</p></li>
<li><p>Dans quel espace stéréotaxique les analyses de groupe sont-elles effectuées?</p></li>
<li><p>Quel type de mesure de connectivité est utilisée dans l’article?</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5.8.</p>
<p>On souhaite comparer la connectivité fonctionnelle entre des personnes jeunes et âgées. Citez trois facteurs de confusion potentiel, qui ne sont pas liés à l’activité neuronale intrinsèque.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="irm_fonctionnelle.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">IRM fonctionnelle</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="irm_diffusion.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">IRM de diffusion</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Pierre Bellec et l'équipe PSY3018<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>